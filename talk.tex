\documentclass[aspectratio=169,handout]{beamer}

\makeatletter
\appto\input@path{{libs/awesome-beamer}, {libs/smile}}
\makeatother

\definecolor{dred}{HTML}{501613}
\usetheme[english, color, coloraccent=dred, listings]{awesome}

\usepackage[
	backend=biber,
	style=alphabetic
]{biblatex}
\usepackage[strict,autostyle]{csquotes}
\nocite{*}
\addbibresource{refs.bib}

\usepackage{fontspec}
\setsansfont[
	Ligatures=TeX,
	BoldFont={* Medium},
]{Fira Sans}
\setmonofont[
	Path = ./fonts/,
	Scale = .9,
	Extension = .ttf,
	Contextuals=Alternate,
	BoldFont={*-Bold},
	UprightFont={*-Regular},
]{Fira Code}

\usepackage[duration=90]{pdfpc}
\newcommand<>{\talknote}[1]{\only#2{\pdfpcnote{- #1}\relax}}

\usepackage[verbatim]{lstfiracode}
\lstdefinestyle{firastyleb}{style=FiraCodeStyle,style=smile@lst@base}
\lstdefinestyle{firastylep}{style=FiraCodeStyle,style=smile@lst@plain}
\lstset{
	tabsize=4,
	style=firastylep,
	%apptoliterate={{=> }{{{=> }}}3} % for whatever reason, the space would otherwise be eaten
}
\lstdefinelanguage{myhaskell}{
	language=haskell,
	morekeywords={MonadReader,Getting,ASetter,Lens},
}
\newcommand\h[2][]{\lstinline[language=myhaskell,#1]{#2}}
\lstnewenvironment{haskell}{\lstset{language=myhaskell}}{}

\background{background.jpg}
\title{Lenses}
\subtitle{Functional Programming II}
\author{Lukas Pietzschmann}
\email{lukas.pietzschmann@uni-ulm.de}
\institute{Institute of Software Engineering and Programming Languages}
\uni{Ulm University}
\location{Ulm}
\date{May 13$^\text{th}$, 2024}

\addtobeamertemplate{title page}{}{
\tikz[o]\node[anchor=south east,outer sep=0pt] at (current page.south east)
{\fontsize{4}{4}\selectfont\color{white}This image was generated by AI (DALLE 3)};
}

\begin{document}
\maketitle

\section{What}

\begingroup
\colorlet{m}{blue!45!black}
\colorlet{accent}{m}
\makeatletter\smile@listings@initcolors\makeatother
\setbeamercolor{footline}{fg=white,bg=m}
\setbeamercolor{footlineright}{fg=white,bg=m}
\def\qn#1{\textcolor{orange!80!black}{\textbf{#1}}}
\begin{frame}[t,fragile]
	\frametitle{What are lenses}
	\tikzset{q/.style={chamfered rectangle,draw,lw,chamfered rectangle xsep=2cm,fill=m,text=white}}
	\tikzset{qa/.style={q,text width=0.4\textwidth}}
	\begin{wide}\vspace{5mm}
		\begin{haskell}
			type Lens s t a b = forall f. Functor f => (a -> f b) -> s -> f t

			view :: MonadReader s m => Getting a s a -> m a
			set  :: ASetter s t a b -> b -> s -> t
		\end{haskell}
		\begin{tikzpicture}[o,node distance=.5ex]
			\draw[draw=none,top color=white,bottom color=m] (current page.west) rectangle ([yshift=1.8ex]current page.south east);

			\node[q] at ([yshift=-5mm]current page) (Q) {What is the purpose of a lens, according to the types above?};
			\coordinate (AS) at ([yshift=-1.3cm]Q.south);

			\node[qa,left=of AS,left] (A) {\scriptsize\qn{A:} A package for creating visualizations};
			\node[qa,right=of AS,right] (B) {\scriptsize\qn{B:} A tool for handling nested ADTs};

			\node[qa,below=of A] (C) {\scriptsize\qn{C:} A framework for building UIs};
			\node[qa,below=of B] (D) {\scriptsize\qn{D:} A package for simulating optical lenses};

			\draw[lw,short=-1pt] (A.east) to (B.west);
			\draw[lw,short=-1pt] (C.east) to (D.west);

			\draw[lw,short=-1pt] (Q.west) to (Q.west -| current page.west);
			\draw[lw,short=-1pt] (Q.east) to (Q.east -| current page.east);

			\draw[lw,short=-1pt] (A.west) to (A.west -| current page.west);
			\draw[lw,short=-1pt] (C.west) to (C.west -| current page.west);
			\draw[lw,short=-1pt] (B.east) to (B.east -| current page.east);
			\draw[lw,short=-1pt] (D.east) to (D.east -| current page.east);
		\end{tikzpicture}
	\end{wide}
\end{frame}
\endgroup

\section{References}
\defbibheading{bibliography}[\bibname]{}
\begin{frame}[allowframebreaks]
	\frametitle{References}
	\printbibliography
\end{frame}
\end{document}
